(()=>{var l=class extends HTMLElement{constructor(){super(),this.selectedMode=!1,this.$search=this.querySelector("input")??document.createElement("INPUT"),this.$results=document.createElement("DIV"),this.$results.classList.add("results"),this.$results.hidden=!0,this.$select=this.querySelector("select"),this.$selectedResult=void 0,this.render()}render(){this.setupSearch(),this.setDefault(),this.renderResults(),this.setEvents(),this.observeOptions()}observeOptions(){new MutationObserver(()=>{this.setDefault(),this.renderResults()}).observe(this.$select,{childList:!0})}static get observedAttributes(){return["placeholder","aria-label"]}attributeChangedCallback(e,t,s){this.$search.setAttribute(e,s)}toggleResults(){this.$results.toggleAttribute("hidden")}setupSearch(){let e=document.createElement("searchable-select-container");e.classList.add("container"),e.prepend(this.$search,this.$results),this.prepend(e)}updateHover(e){let t=this.$results.querySelector("[data-hover]");t&&t.removeAttribute("data-hover"),e&&e.setAttribute("data-hover","")}updateSelected(e){let t=this.$select.querySelector("option[selected]");t&&t.removeAttribute("selected"),this.$select.querySelector(`option[value="${e}"]`).toggleAttribute("selected")}handleKeyoard(e){let t=this.$results.querySelector("[data-hover]");if(t){if(e.key==="ArrowDown"){e.preventDefault();let s=t.nextElementSibling;if(!s)return;this.updateHover(s),t.scrollIntoView();return}if(e.key==="ArrowUp"){e.preventDefault();let s=t.previousElementSibling;if(!s)return;this.updateHover(s),s.scrollIntoView();return}if(e.key==="Enter"){e.preventDefault(),t.click();return}}}setEvents(){this.$search.addEventListener("click",()=>{this.selectedMode=!this.selectedMode,this.selectedMode?this.$search.select():(this.$search.blur(),this.updateHover(this.$selectedResult)),this.$selectedResult?.scrollIntoView(),this.toggleResults()});let e=this.handleKeyoard.bind(this);this.$search.addEventListener("focus",()=>{this.$search.addEventListener("keydown",e)}),this.$search.addEventListener("blur",()=>{this.$search.removeEventListener("keydown",e)}),this.$search.addEventListener("input",()=>{this.renderResults(this.$search.value)}),this.$results.addEventListener("click",({target:t})=>{this.selectedMode=!1,this.$select.value=t.dataset.value,this.updateSelected(t.dataset.value),this.setSearch(t.textContent),this.toggleResults(),this.renderResults()})}getOptions(){return Array.from(this.querySelectorAll("option"))}renderResults(e=""){let t=this.getResults(e);this.$results.replaceChildren(...t);let s=this.$results.querySelector("[data-selected]")??t[0];this.updateHover(s)}setSearch(e){this.$search.value=e.trim()}setDefault(){let e=this.querySelector("option[selected]");if(e)this.setSearch(e.textContent);else{let t=document.createElement("option");t.setAttribute("selected",""),this.$select.prepend(t)}}getResults(e=void 0){let t=this.getOptions(),s=[];for(let r of t){let i=r.textContent.trim(),o=r.hasAttribute("selected");if(!i)continue;let n=this.createResult({value:r.value,status:o,content:i});e?i.toLocaleLowerCase().trim().includes(e.toLocaleLowerCase().trim())&&s.push(n):s.push(n)}return s}createResult({value:e,status:t,content:s}){let r=document.createElement("DIV");return r.className="result",r.dataset.value=e,t&&(r.setAttribute("data-selected",""),this.$selectedResult=r),r.textContent=s,r}};window.customElements.define("searchable-select",l);})();
